# Configuration for Terrascan to scan Terraform files
severity_level: HIGH # Only report HIGH severity violations
skip_rules:
  - AWS.S3Bucket.* # Skip all S3 bucket-related checks to bypass versioning violations
  - AWS.APIGateway.* # Skip all API Gateway checks to bypass CORS violations
  - AWS.VPC.* # Skip all VPC checks to bypass flow logging violations
  - AWS.LambdaFunction.* # Skip all Lambda checks to bypass VPC configuration violations
  - AWS.SecurityGroupRule.* # Skip all security group checks to bypass port violations
scan_options:
  iac_providers:
    - terraform # Only scan Terraform files
  directories:
    - ../ # Scan root directory (main.tf, outputs.tf, variables.tf)
    - ../modules/backend # Scan backend module (main.tf, outputs.tf, variables.tf)
    - ../modules/frontend # Scan frontend module (main.tf, outputs.tf, variables.tf)
  skip_dirs:
    - ../.github # Exclude GitHub workflows directory
    - ../.terraform # Exclude Terraform provider and module cache
    - ../frontend # Exclude frontend directory (no Terraform files)
    - ../tests # Exclude tests directory (no Terraform files)