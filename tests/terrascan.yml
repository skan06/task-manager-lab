# Configuration for Terrascan to scan Terraform files
severity_level: HIGH # Only report HIGH severity violations
skip_rules:
  - AWS.LambdaFunction.IAM.1 # Skip KMS check for Lambda IAM role
  - AWS.S3Bucket.Versioning.1 # Skip S3 versioning check (already enabled in frontend module)
  - AWS.APIGateway.CORS.1 # Skip CORS check (restricted to S3 endpoint)
  - AWS.VPC.Logging.1 # Skip VPC flow logging check
  - AWS.LambdaFunction.VPC.1 # Skip Lambda VPC configuration check
  - AWS.SecurityGroupRule.Cidr.3 # Skip security group unrestricted ports check
scan_options:
  iac_providers:
    - terraform # Only scan Terraform files
  directories:
    - ../ # Scan root directory (main.tf, outputs.tf, variables.tf)
    - ../modules/backend # Scan backend module (main.tf, outputs.tf, variables.tf)
    - ../modules/frontend # Scan frontend module (main.tf, outputs.tf, variables.tf)
  skip_dirs:
    - ../.github # Exclude GitHub workflows directory
    - ../.terraform # Exclude Terraform provider and module cache
    - ../frontend # Exclude frontend directory (no Terraform files)
    - ../tests # Exclude tests directory (no Terraform files)